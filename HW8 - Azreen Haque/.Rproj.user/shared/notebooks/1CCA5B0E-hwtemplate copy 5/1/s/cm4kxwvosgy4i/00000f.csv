"0","### Part C: Weighted Least Squares (WLS)"
"0",""
"0","# Step 1: Fit the original model"
"0","model_ols <- lm(Y ~ X, data = data2)"
"0",""
"0","# Step 2: Compute squared residuals"
"0","resid_sq <- resid(model_ols)^2"
"0",""
"0","# Step 3: Compute weights as inverse of squared residuals"
"0","weights <- 1 / resid_sq"
"0",""
"0","# Step 4: Fit WLS model using these weights"
"0","model_wls <- lm(Y ~ X, data = data2, weights = weights)"
"0",""
"0","# Step 5: View WLS summary"
"0","summary(model_wls)"
"1","
Call:
"
"1",""
"1","lm(formula = Y ~ X, data = data2, weights = weights)"
"1",""
"1","

"
"1","Weighted "
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-0.8453 "
"1","-0.6901 "
"1","-0.3842 "
"1"," 1.1876 "
"1"," 1.4545 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," 10.437535"
"1","   3.093161"
"1","   3.374"
"1","  0.00301"
"1"," ** "
"1","
X          "
"1","  0.102937"
"1","   0.006228"
"1","  16.528"
"1"," 3.97e-13"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9379"
"1"," "
"1","on"
"1"," "
"1","20"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.9318"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.9284"
"1"," "
"1","
F-statistic:"
"1"," "
"1","273.2"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","20"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","3.97e-13"
"1","
"
"1","
"
"0","# Step 6: Extract and print fitted equation"
"0","coefs_wls <- coef(model_wls)"
"0","cat(""WLS Fitted Equation:\n"")"
"1","WLS Fitted Equation:
"
"0","cat(""Ŷ ="", round(coefs_wls[1], 5), ""+"", round(coefs_wls[2], 5), ""*X\n"")"
"1","Ŷ ="
"1"," "
"1","10.43753"
"1"," "
"1","+"
"1"," "
"1","0.10294"
"1"," "
"1","*X
"
