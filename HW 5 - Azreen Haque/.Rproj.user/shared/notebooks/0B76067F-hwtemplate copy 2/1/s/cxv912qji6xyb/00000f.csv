"0","X_data <- data$Children"
"0","Y_data <- data$Hours"
"0","n <- length(X_data)"
"0",""
"0","# Design matrix X and response matrix Y"
"0","X <- cbind(1, X_data)"
"0","Y <- matrix(Y_data, nrow = n, ncol = 1)"
"0",""
"0","# Calculate matrices in R"
"0","XtX <- t(X) %*% X"
"0","XtY <- t(X) %*% Y"
"0","XtX_inv <- solve(XtX)"
"0",""
"0","# Calculate b (Regression coefficients)"
"0","b <- XtX_inv %*% XtY"
"0",""
"0","# Calculate Y-hat (Fitted values)"
"0","Y_hat <- X %*% b"
"0",""
"0","# Calculate e (Residuals)"
"0","e <- Y - Y_hat"
"0",""
"0","# Output all matrices"
"0","cat(""X'X:\n""); print(XtX)"
"1","X'X:
"
"1","      "
"1","   "
"1"," X_data"
"1","
      "
"1","  6"
"1","     24"
"1","
X_data"
"1"," 24"
"1","    142"
"1","
"
"0","cat(""\nDimension of X'X:"", dim(XtX), ""\n\n"")"
"1","
Dimension of X'X:"
"1"," "
"1","2"
"1"," "
"1","2"
"1"," "
"1","

"
"0","cat(""X'Y:\n""); print(XtY)"
"1","X'Y:
"
"1","      "
"1"," [,1]"
"1","
      "
"1","   82"
"1","
X_data"
"1","  385"
"1","
"
"0","cat(""\nDimension of X'Y:"", dim(XtY), ""\n\n"")"
"1","
Dimension of X'Y:"
"1"," "
"1","2"
"1"," "
"1","1"
"1"," "
"1","

"
"0","cat(""(X'X)^-1:\n""); print(XtX_inv)"
"1","(X'X)^-1:
"
"1","      "
"1","            "
"1","      X_data"
"1","
      "
"1","  0.51449275"
"1"," -0.08695652"
"1","
X_data"
"1"," -0.08695652"
"1","  0.02173913"
"1","
"
"0","cat(""\nDimension of (X'X)^-1:"", dim(XtX_inv), ""\n\n"")"
"1","
Dimension of (X'X)^-1:"
"1"," "
"1","2"
"1"," "
"1","2"
"1"," "
"1","

"
"0","cat(""b (coefficients):\n""); print(b)"
"1","b (coefficients):
"
"1","      "
"1","     [,1]"
"1","
      "
"1"," 8.710145"
"1","
X_data"
"1"," 1.239130"
"1","
"
"0","cat(""\nDimension of b:"", dim(b), ""\n\n"")"
"1","
Dimension of b:"
"1"," "
"1","2"
"1"," "
"1","1"
"1"," "
"1","

"
"0","cat(""Y-hat (fitted values):\n""); print(Y_hat)"
"1","Y-hat (fitted values):
"
"1","    "
"1","      [,1]"
"1","
[1,]"
"1"," 11.188406"
"1","
[2,]"
"1"," 16.144928"
"1","
[3,]"
"1"," 13.666667"
"1","
[4,]"
"1"," 11.188406"
"1","
[5,]"
"1","  9.949275"
"1","
[6,]"
"1"," 19.862319"
"1","
"
"0","cat(""\nDimension of Y-hat:"", dim(Y_hat), ""\n\n"")"
"1","
Dimension of Y-hat:"
"1"," "
"1","6"
"1"," "
"1","1"
"1"," "
"1","

"
"0","cat(""e (residuals):\n""); print(e)"
"1","e (residuals):
"
"1","    "
"1","       [,1]"
"1","
[1,]"
"1","  1.8115942"
"1","
[2,]"
"1","  0.8550725"
"1","
[3,]"
"1"," -2.6666667"
"1","
[4,]"
"1","  0.8115942"
"1","
[5,]"
"1"," -0.9492754"
"1","
[6,]"
"1","  0.1376812"
"1","
"
"0","cat(""\nDimension of e:"", dim(e), ""\n\n"")"
"1","
Dimension of e:"
"1"," "
"1","6"
"1"," "
"1","1"
"1"," "
"1","

"
"0","# Fitted regression equation"
"0","cat(sprintf(""Fitted Regression Equation: Y_hat = %.3f + %.3f*X\n"", b[1], b[2]))"
"1","Fitted Regression Equation: Y_hat = 8.710 + 1.239*X
"
