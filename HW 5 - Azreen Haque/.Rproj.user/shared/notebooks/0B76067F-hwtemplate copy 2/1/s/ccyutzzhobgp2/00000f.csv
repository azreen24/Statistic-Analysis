"0","H_transpose <- t(H)"
"0","HH <- H %*% H"
"0",""
"0","# Check symmetry"
"0","is_symmetric <- all.equal(H, H_transpose, tolerance=1e-5)"
"0",""
"0","# Check idempotency"
"0","is_idempotent <- all.equal(HH, H, tolerance=1e-5)"
"0",""
"0","cat(""\nHat Matrix symmetry check (H' = H):"", is_symmetric, ""\n"")"
"1","
Hat Matrix symmetry check (H' = H):"
"1"," "
"1","TRUE"
"1"," "
"1","
"
"0","cat(""Hat Matrix idempotent check (HH = H):"", is_idempotent, ""\n"")"
"1","Hat Matrix idempotent check (HH = H):"
"1"," "
"1","TRUE"
"1"," "
"1","
"
