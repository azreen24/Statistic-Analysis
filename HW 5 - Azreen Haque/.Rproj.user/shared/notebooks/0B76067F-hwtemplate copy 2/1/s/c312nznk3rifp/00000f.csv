"0","# Hat Matrix (H) calculation"
"0","H <- X %*% XtX_inv %*% t(X)"
"0",""
"0","# Display Hat matrix and its dimension"
"0","cat(""Hat Matrix (H):\n"")"
"1","Hat Matrix (H):
"
"0","print(H)"
"1","    "
"1","        [,1]"
"1","       [,2]"
"1","      [,3]"
"1","        [,4]"
"1","        [,5]"
"1","        [,6]"
"1","
[1,]"
"1","  0.25362319"
"1"," 0.07971014"
"1"," 0.1666667"
"1","  0.25362319"
"1","  0.29710145"
"1"," -0.05072464"
"1","
[2,]"
"1","  0.07971014"
"1"," 0.25362319"
"1"," 0.1666667"
"1","  0.07971014"
"1","  0.03623188"
"1","  0.38405797"
"1","
[3,]"
"1","  0.16666667"
"1"," 0.16666667"
"1"," 0.1666667"
"1","  0.16666667"
"1","  0.16666667"
"1","  0.16666667"
"1","
[4,]"
"1","  0.25362319"
"1"," 0.07971014"
"1"," 0.1666667"
"1","  0.25362319"
"1","  0.29710145"
"1"," -0.05072464"
"1","
[5,]"
"1","  0.29710145"
"1"," 0.03623188"
"1"," 0.1666667"
"1","  0.29710145"
"1","  0.36231884"
"1"," -0.15942029"
"1","
[6,]"
"1"," -0.05072464"
"1"," 0.38405797"
"1"," 0.1666667"
"1"," -0.05072464"
"1"," -0.15942029"
"1","  0.71014493"
"1","
"
"0","cat(""\nDimension of H:"", dim(H), ""\n\n"")"
"1","
Dimension of H:"
"1"," "
"1","6"
"1"," "
"1","6"
"1"," "
"1","

"
"0","# Compute fitted values using Hat matrix"
"0","Y_hat_H <- H %*% Y"
"0","cat(""Fitted values (Y_hat) using Hat Matrix:\n"")"
"1","Fitted values (Y_hat) using Hat Matrix:
"
"0","print(Y_hat)"
"1","    "
"1","      [,1]"
"1","
[1,]"
"1"," 11.188406"
"1","
[2,]"
"1"," 16.144928"
"1","
[3,]"
"1"," 13.666667"
"1","
[4,]"
"1"," 11.188406"
"1","
[5,]"
"1","  9.949275"
"1","
[6,]"
"1"," 19.862319"
"1","
"
"0","# Verify if the fitted values match those from lm()"
"0","Y_hat_lm <- fitted(model)"
"0","match_fitted <- all.equal(as.vector(Y_hat), as.vector(Y_hat_lm), tolerance=1e-5)"
"0",""
"0","if(isTRUE(match_fitted)){"
"0","  cat(""\nFitted values from Hat Matrix match those from lm().\n\n"")"
"0","} else {"
"0","  cat(""Fitted values do NOT match.\n"")"
"0","}"
"1","
Fitted values from Hat Matrix match those from lm().

"
