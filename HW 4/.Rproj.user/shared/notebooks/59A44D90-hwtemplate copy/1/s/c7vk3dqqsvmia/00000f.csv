"0","# Define confidence level"
"0","alpha <- 0.10  # 90% confidence level"
"0",""
"0","# Sample size"
"0","n <- nrow(data)"
"0",""
"0","# Compute MSE"
"0","MSE <- sum(residuals(model)^2) / (n - 2)"
"0",""
"0","# Compute the mean of X (Copiers)"
"0","Xbar <- mean(data$Copiers)"
"0",""
"0","# Compute SXX"
"0","SXX <- sum((data$Copiers - Xbar)^2)"
"0",""
"0","# Compute F critical value for Working-Hotelling procedure"
"0","F_critical_wh <- qf(1 - alpha, df1 = 2, df2 = n-2)"
"0",""
"0","# Function to calculate Working-Hotelling confidence interval at given X_h"
"0","wh_confidence_interval <- function(X_h) {"
"0","  # Compute predicted Y value"
"0","  Y_hat <- coef(model)[1] + coef(model)[2] * X_h"
"0","  "
"0","  # Compute standard error"
"0","  SE_Y_hat <- sqrt(MSE * (1/n + ((X_h - Xbar)^2 / SXX)))"
"0","  "
"0","  # Compute confidence interval bounds"
"0","  margin_of_error <- sqrt(2 * F_critical_wh) * SE_Y_hat"
"0","  lower_bound <- Y_hat - margin_of_error"
"0","  upper_bound <- Y_hat + margin_of_error"
"0","  "
"0","  return(c(lower_bound, upper_bound))"
"0","}"
"0",""
"0","# Calculate joint confidence intervals for X_h = 2, 4, 6, 8"
"0","WH_CI_results <- t(sapply(X_h_values, wh_confidence_interval))"
"0",""
"0","# Display results"
"0","colnames(WH_CI_results) <- c(""Lower Bound"", ""Upper Bound"")"
"0","rownames(WH_CI_results) <- paste(""X_h ="", X_h_values)"
"0","print(WH_CI_results)"
"1","       "
"1"," Lower Bound"
"1"," Upper Bound"
"1","
X_h = 2"
"1","    25.06746"
"1","    33.91321"
"1","
X_h = 4"
"1","    56.40131"
"1","    62.72036"
"1","
X_h = 6"
"1","    86.55263"
"1","    92.71003"
"1","
X_h = 8"
"1","   115.45338"
"1","   123.95028"
"1","
"
