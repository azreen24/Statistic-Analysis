"0","model_f <- lm(market.share ~ price + discount + rating, data = data2)"
"0","summary(model_f)"
"1","
Call:
"
"1",""
"1","lm(formula = market.share ~ price + discount + rating, data = data2)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-0.49562 "
"1","-0.19618 "
"1","-0.02018 "
"1"," 0.10332 "
"1"," 1.53481 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1","  2.6590792"
"1","  0.4335651"
"1","   6.133"
"1"," 5.79e-07"
"1"," ***"
"1","
price      "
"1"," -0.1916380"
"1","  0.1784635"
"1","  -1.074"
"1","   0.2905"
"1","    "
"1","
discount   "
"1","  0.3104420"
"1","  0.1138419"
"1","   2.727"
"1","   0.0100"
"1"," *  "
"1","
rating     "
"1","  0.0007680"
"1","  0.0003037"
"1","   2.529"
"1","   0.0162"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.3429"
"1"," "
"1","on"
"1"," "
"1","34"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.2717"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.2074"
"1"," "
"1","
F-statistic:"
"1"," "
"1","4.228"
"1"," "
"1","on"
"1"," "
"1","3"
"1"," "
"1","and"
"1"," "
"1","34"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.01211"
"1","
"
"1","
"
"0","anova(model_f)"
"1","Analysis of Variance Table
"
"1","
"
"1","Response: market.share"
"1","
"
"1","         "
"1"," Df"
"1"," Sum Sq"
"1"," Mean Sq"
"1"," F value"
"1","  Pr(>F)"
"1","  "
"1","
price    "
"1","  1"
"1"," 0.0432"
"1"," 0.04325"
"1","  0.3679"
"1"," 0.54821"
"1","  "
"1","
discount "
"1","  1"
"1"," 0.6959"
"1"," 0.69594"
"1","  5.9194"
"1"," 0.02039"
"1"," *"
"1","
rating   "
"1","  1"
"1"," 0.7519"
"1"," 0.75191"
"1","  6.3955"
"1"," 0.01625"
"1"," *"
"1","
Residuals"
"1"," 34"
"1"," 3.9974"
"1"," 0.11757"
"1","        "
"1","        "
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"0","# Manually confirm stats for: model_f = price + discount + rating"
"0","# You already fit this:"
"0","model_f <- lm(market.share ~ price + discount + rating, data = data2)"
"0","model_full <- lm(market.share ~ price + discount + promotion + rating, data = data2)"
"0",""
"0","# Sample size and number of predictors"
"0","n <- nrow(data2)"
"0","p <- 3   # number of predictors in model_f"
"0","p_full <- 4"
"0",""
"0","# Extract RSS (Residual Sum of Squares)"
"0","rss <- sum(resid(model_f)^2)"
"0",""
"0","# Total Sum of Squares (SST)"
"0","sst <- sum((data2$market.share - mean(data2$market.share))^2)"
"0",""
"0","# R-squared"
"0","r_squared <- 1 - rss / sst"
"0",""
"0","# Adjusted R-squared"
"0","adj_r_squared <- 1 - (rss / (n - p - 1)) / (sst / (n - 1))"
"0",""
"0","# Get MSE from full model"
"0","mse_full <- summary(model_full)$sigma^2  # sigma is residual std error"
"0",""
"0","# Mallows' Cp"
"0","cp <- rss / mse_full - (n - 2 * p)"
"0",""
"0","# Show results"
"0","cat(""Manual calculations:\n"")"
"1","Manual calculations:
"
"0","cat(""R-squared:         "", round(r_squared, 4), ""\n"")"
"1","R-squared:         "
"1"," "
"1","0.2717"
"1"," "
"1","
"
"0","cat(""Adjusted R-squared:"", round(adj_r_squared, 4), ""\n"")"
"1","Adjusted R-squared:"
"1"," "
"1","0.2074"
"1"," "
"1","
"
"0","cat(""Mallows' Cp:       "", round(cp, 4), ""\n"")"
"1","Mallows' Cp:       "
"1"," "
"1","2.5662"
"1"," "
"1","
"
