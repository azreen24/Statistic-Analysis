"0","# Load leaps package"
"0","library(leaps)"
"0",""
"0","# Run subset selection"
"0","subset_model <- regsubsets(market.share ~ price + discount + promotion + rating,"
"0","                           data = data2, nbest = 3)"
"0",""
"0","# Display summary"
"0","subset_summary <- summary(subset_model)"
"0",""
"0","# Show results"
"0","print(data.frame("
"0","  Variables = apply(subset_summary$which, 1, function(x) paste(names(x)[x][-1], collapse = "", "")),"
"0","  R2 = round(subset_summary$rsq, 4),"
"0","  Adj_R2 = round(subset_summary$adjr2, 4),"
"0","  Cp = round(subset_summary$cp, 4)"
"0","))"
